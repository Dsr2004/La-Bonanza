{% extends 'base.html' %}
{% load static %}
{% block titulo %}Calendario{% endblock titulo %}

{% block estilos %}
<link rel="stylesheet" href="{% static 'libs/fullcalendar/lib/main.css' %}">
<link rel="stylesheet" href="{% static 'libs/daterangepicker/daterangepicker.css' %}">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
{% endblock estilos %}


{% block contenido %}
<br>
<div class="container">
    <a href="{% url 'asistencia' %}" class="btn btn-outline-secondary w-100">Gestionar Asistencia</a>
</div>
<div id="calendar" style="padding: 40px"></div>

<div class="modal fade" id="ModalInfoEstudianteCalendario" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true"></div>
{% endblock contenido %}



{% block scripts %}
<script src="{% static 'libs/fullcalendar/lib/main.js' %}"></script>
<script src="{% static 'libs/fullcalendar/lib/locales-all.js' %}"></script>
<script src="{% static 'libs/daterangepicker/moment.min.js' %}"></script>
<script src="{% static 'libs/daterangepicker/daterangepicker.js' %}"></script>
<script>
    document.addEventListener("DOMContentLoaded", function(){
        var CalenadrUI = document.getElementById("calendar")
        var calendar = new FullCalendar.Calendar(CalenadrUI,{
            eventTimeFormat: { 
                hour: '2-digit',
                minute: '2-digit',
                hour12: true
            },
            headerToolbar: {
                left: 'prev,next today',
                center: 'title',
                right: 'dayGridMonth,timeGridWeek,timeGridDay,listWeek'
            },
            events: [
            {%for clase in clases %}
                {
                id: '{%url 'verInfoEstudianteCalendario' clase.pk%}',
                title : '{{clase.registro.get_estudiante}}',
                startRecur : '{{clase.inicioClase|date:"Y-m-d"}}',
                endRecur : '{{clase.finClase|date:"Y-m-d"}}',

                startTime: '{{clase.horaClase|date:"H:i"}}',
                daysOfWeek: ['{{clase.diaClase|safe}}'],
                color: '{{clase.registro.nivel.color_fondo}}',
                textColor: '{{clase.registro.nivel.color_letra}}',
                },
                
            {%endfor%}

            ],
            eventClick: function(arg) {
            abrir_modal_calendario(arg.event.id)
      },
        })

        calendar.render();
        calendar.setOption('locale','es')

    })
</script>
{% endblock scripts %}

