{% extends 'base.html' %}
{% load jsonify %}
{% load static %}
{% block titulo %}Crear Estudiante{% endblock titulo %}
{% block estilos %}
<link rel="stylesheet" href="{% static 'libs/datepicker/dist/datepicker.css' %}">

<style>
    input{border: 1px solid #dadce0;border-radius: 4px;box-shadow: 0 0 0 transparent;font-size: 16px;line-height: 17px;outline: transparent;padding: 11px 16px;transition: border .3s, box-shadow .3s;width: 100%;}
    select{border: 1px solid #dadce0;border-radius: 4px;box-shadow: 0 0 0 transparent;font-size: 17px;line-height: 24px;outline: transparent;padding: 11px 16px;transition: border .3s, box-shadow .3s;width: 100%;}
    .formulario{display: grid;grid-template-columns:repeat(2, 1fr);grid-gap:30px;}
    .checkbox{display: grid;grid-template-columns: 80% 20%;}
    @media (max-width: 700px) {.formulario{display: grid;grid-template-columns:repeat(1, 1fr);grid-gap:30px;}}
</style>{% endblock estilos %}
{% block contenido %}
<style>
    #DivContrato::-webkit-scrollbar {
        width: 8px;     /* Tamaño del scroll en vertical */
        height: 8px;    /* Tamaño del scroll en horizontal */
        border-radius: 5px;
        background-color: #ccc;
    }
    #DivContrato::-webkit-scrollbar-thumb {
        background: #0dcaf0;
        border-radius: 4px;
    }
</style>
<div id="fondoContrato"style="display:none; width:100%; position:fixed; top:0; height:100vh; background-color:rgba(0,0,0,0.5);"><div id="DivContrato" style="width:90%;height: 90vh;background-color: #fff; position:absolute; top:2.5%;left: 5%; border: 1px solid rgba(0,0,0,1); z-index: 100; border-radius: 5px;overflow: auto;"><div id="header" style="width: 88%; margin: 0 1%; height:60px; border-bottom: 1px solid rgba(0,0,0,0.3); display:grid;grid-template-columns: 96% 4%; padding: 0 10px; position: fixed; background-color: #fff;"><h1 id="titleContrato"></h1><i class="fa fa-close" style="position:relative; right: -5px!important; top: 17px; font-size: 24px; cursor: pointer;" onclick="hideContrato()"></i></div><div id="contentContrato" style="margin-top: 70px; display: grid;grid-template-columns: 1fr; grid-gap:5px; padding: 15px;"></div><div><label for="AceptacionContrato" style="padding: 0 20px;">Aceptación del contrato <sup style="color: red;">*</sup></label><div class="form-check form-switch" ><input class="form-check-input" type="checkbox" style="margin-left: -20px; width: 50px;" role="switching" name="AceptacionContrato" id="AceptacionContrato"  onclick="if (document.getElementById('LAC').innerHTML == 'No'){document.getElementById('LAC').innerHTML='Si'}else{document.getElementById('LAC').innerHTML='No'}"> <label for="AceptacionContrato" style="margin-top: 5px; margin-left: 10px;" id="LAC">No</label></div><br><div style="float: right; margin-right: 40px ;"><button type="button" class="btn btn-default" style="background-color: #ccc; margin-right: 10px;"onclick="hideContrato()">Cancelar</button><button type="button" class="btn btn-info"onclick="guardarContrato()">Guardar</button><br><br></div></div></div></div>
<div class="container-fluid">
    <form action="{% url 'registrarEstudiante' %}" method="post" enctype="multipart/form-data" id="CrearEstudianteForm">
        {% csrf_token %}
        <br>
        <h1><center>Registro Estudiante</center></h1>
        <br>
        <div class="container">
            <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                <li class="nav-item" role="presentation">
                  <button class="nav-link active" id="pills-home-tab" data-bs-toggle="pill" data-bs-target="#pills-home" type="button" role="tab" aria-controls="pills-home" aria-selected="true">Estudiante</button>
                </li>
                <li class="nav-item" role="presentation">
                  <button class="nav-link" id="pills-profile-tab" data-bs-toggle="pill" data-bs-target="#pills-profile" type="button" role="tab" aria-controls="pills-profile" aria-selected="false">Padres</button>
                </li>
                <li class="nav-item" role="presentation">
                  <button class="nav-link" id="pills-contact-tab" data-bs-toggle="pill" data-bs-target="#pills-contact" type="button" role="tab" aria-controls="pills-contact" aria-selected="false">Contacto de Emergencia</button>
                </li>
                <li class="nav-item" role="presentation">
                  <button class="nav-link" id="pills-disabled-tab" data-bs-toggle="pill" data-bs-target="#pills-disabled" type="button" role="tab" aria-controls="pills-disabled" aria-selected="false">Documentos</button>
                </li>
              </ul>
              <div class="tab-content" id="pills-tabContent">
                <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab" tabindex="0">
                    <h3>Información del estudiante</h3>
                    <hr>
                    <div class="row">
                        <div class="col-md-6">
                            <label for="" style="font-weight: 500;">{{form.nombre_completo.label}}:</label>
                            {{form.nombre_completo}}
                            <p id="nombre_completo" class="error_text"></p>
                        </div>
                        <div class="col-md-6">
                            <label for="" style="font-weight: 500;">{{form.fecha_nacimiento.label}}:</label>
                            {{form.fecha_nacimiento}}
                            <p id="fecha_nacimiento" class="error_text"></p>
                        </div>
                    </div>
                    <br>
                    <div class="row">
                        <div class="col-md-6">
                            <label for="" style="font-weight: 500;">{{form.documento.label}}:</label>
                            {{form.documento}}
                            <p id="documento" class="error_text"></p>
                        </div>
                        <div class="col-md-6">
                            <label for="" style="font-weight: 500;">{{form.celular.label}}:</label>
                            {{form.celular}}
                            <p id="celular" class="error_text"></p>
                        </div>
                    </div>
                    <br>
                    <div class="row">
                        <div class="col-md-6">
                            <label for="" style="font-weight: 500;">{{form.email.label}}:</label>
                            {{form.email}}
                            <p id="email" class="error_text"></p>
                        </div>
                        <div class="col-md-6">
                            <label for="" style="font-weight: 500;">{{form.direccion.label}}:</label>
                            {{form.direccion}}
                            <p id="direccion" class="error_text"></p>
                        </div>
                    </div>
                   <br>
                   <div class="row">
                        <div class="col-md-6">
                            <label for="" style="font-weight: 500;">{{form.barrio.label}}:</label>
                            {{form.barrio}}
                            <p id="barrio" class="error_text"></p>
                        </div>
                        <div class="col-md-6">
                            <label for="" style="font-weight: 500;">{{form.ciudad.label}}:</label>
                            {{form.ciudad}}
                            <p id="ciudad" class="error_text"></p>
                        </div>
                   </div>
                   <div class="row">
                        <div class="col-md-6">
                            <label for="" style="font-weight: 500;">{{form.seguro.label}}:</label>
                            {{form.seguro}}
                            <p id="seguro" class="error_text"></p>
                        </div>
                        <div class="col-md-6">
                            <label for="" style="font-weight: 500;">{{form.poliza.label}}:</label>
                            {{form.poliza}}
                            <p id="poliza" class="error_text"></p>
                        </div>
                    </div>
                    <br>
                    <div class="row">
                        <div class="col-md-6">
                            <label for="" style="font-weight: 500;">{{form.comprobante_seguro_medico.label}}:</label>
                            {{form.comprobante_seguro_medico}}
                            <p id="comprobante_seguro_medico" class="error_text"></p>
                        </div>
                        <div class="col-md-6">
                            <label for="" style="font-weight: 500;">{{form.comprobante_documento_identidad.label}}:</label>
                            {{form.comprobante_documento_identidad}}
                            <p id="comprobante_documento_identidad" class="error_text"></p>
                        </div>
                    </div>
                
                </div>
                <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab" tabindex="0">
                    <h3>Información de los padres</h3>
                    <hr>
                    <h5><center>Información de la Madre</center></h5>
                    <div>
                        <label for="" style="font-weight: 500;">{{form.nombre_completo_madre.label}}:</label>
                        {{form.nombre_completo_madre}}
                        <p id="nombre_completo_madre" class="error_text"></p>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <label for="" style="font-weight: 500;">{{form.cedula_madre.label}}:</label>
                            {{form.cedula_madre}}
                            <p id="cedula_madre" class="error_text"></p>
                        </div>
                        <div class="col-md-6">
                            <label for="" style="font-weight: 500;">{{form.lugar_expedicion_madre.label}}:</label>
                            {{form.lugar_expedicion_madre}}
                            <p id="lugar_expedicion_madre" class="error_text"></p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <label for="" style="font-weight: 500;">{{form.celular_madre.label}}:</label>
                            {{form.celular_madre}}
                            <p id="celular_madre" class="error_text"></p>
                        </div>
                        <div class="col-md-6">
                            <label for="" style="font-weight: 500;">{{form.email_madre.label}}:</label>
                            {{form.email_madre}}
                            <p id="email_madre" class="error_text"></p>
                        </div>
                    </div>
                    <h5><center>Información del Padre</center></h5>
                    <div>
                        <label for="" style="font-weight: 500;">{{form.nombre_completo_padre.label}}:</label>
                        {{form.nombre_completo_padre}}
                        <p id="nombre_completo_padre" class="error_text"></p>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <label for="" style="font-weight: 500;">{{form.cedula_padre.label}}:</label>
                            {{form.cedula_padre}}
                            <p id="cedula_padre" class="error_text"></p>
                        </div>
                        <div class="col-md-6">
                            <label for="" style="font-weight: 500;">{{form.lugar_expedicion_padre.label}}:</label>
                            {{form.lugar_expedicion_padre}}
                            <p id="lugar_expedicion_padre" class="error_text"></p>
                        </div>
                    </div>
                   <div class="row">
                        <div class="col-md-6">
                            <label for="" style="font-weight: 500;">{{form.celular_padre.label}}:</label>
                            {{form.celular_padre}}
                            <p id="celular_padre" class="error_text"></p>
                        </div>
                        <div class="col-md-6">
                            <label for="" style="font-weight: 500;">{{form.email_padre.label}}:</label>
                            {{form.email_padre}}
                            <p id="email_padre" class="error_text"></p>
                        </div>
                   </div>
                   <br>
                   <h4>Información de ubicacion de los padres</h4>
                   <div class="row">
                    <div class="col-md-6">
                        <label for="" style="font-weight: 500;">{{form.direccion.label}}:</label>
                        {{form.direccion}}
                        <p id="direccion" class="error_text"></p>
                        </div>
                        <div class="col-md-6">
                            <label for="" style="font-weight: 500;">{{form.barrio.label}}:</label>
                            {{form.barrio}}
                            <p id="barrio" class="error_text"></p>
                        </div>
                   </div>
                    <div>
                        <label for="" style="font-weight: 500;">{{form.ciudad.label}}:</label>
                        {{form.ciudad}}
                        <p id="ciudad" class="error_text"></p>
                    </div>
                </div>
                <div class="tab-pane fade" id="pills-contact" role="tabpanel" aria-labelledby="pills-contact-tab" tabindex="0">
                    <div>
                        <label for="" style="font-weight: 500;">{{form.nombre_contactoE.label}}:</label>
                        {{form.nombre_contactoE}}
                        <p id="nombre_contactoE" class="error_text"></p>
                    </div>
                    <div>
                        <label for="" style="font-weight: 500;">{{form.telefono_contactoE.label}}:</label>
                        {{form.telefono_contactoE}}
                        <p id="telefono_contactoE" class="error_text"></p>
                    </div>
                    <div>
                        <label for="" style="font-weight: 500;">{{form.relacion_contactoE.label}}:</label>
                        {{form.relacion_contactoE}}
                        <p id="relacion_contactoE" class="error_text"></p>
                    </div>
                </div>
                <div class="tab-pane fade" id="pills-disabled" role="tabpanel" aria-labelledby="pills-disabled-tab" tabindex="0">
                    <h3>Documentos del estudiante</h3>
        <div class="row">
                <div class="col-md-6">
                    {{form.documento_A}}
                    <p id="documento_A" class="error_text"></p>
                </div>
                <div class="col-md-6">
                    {{form.seguro_A}}
                    <p id="seguro_A" class="error_text"></p>
                </div>
                <div>
                    <label for="" style="font-weight: 500;">{{form.firma.label}}:</label>
                    <br>{{form.firma}}<br>
                    <p id="" class="error_text"></p>
                </div>
                   <br>
                <div>
                    <label for="" style="font-weight: 500;">{{form.tipo_clase.label}}:</label>
                    {{form.tipo_clase}}
                    <p id="tipo_clase" class="error_text"></p>
                </div>
                <div>
                    <label for="" style="font-weight: 500;">Contrato:</label><br>
                    <div style="display: flex;">
                        <button id="verContratob" type="button" class="btn btn-xs" style="color: rgb(40, 40, 252);" onclick="verContrato()">Ver el contrato</button><div></div>
                    </div>
                        <p id="aceptaContrato" class="error_text"></p>

                    </div>
                </div>
        </div>
       <br>
       {% comment %}
       <div class="col-md-12">
        <span class="d-block pb-2">Firma digital aqui</span>
        <div class="signature mb-2" style="width: 100%; height: 200px;">
            <canvas id="signature-canvas"
                style="border: 1px dashed red; width: 100%; height: 200px;"></canvas>
        </div>
        <button type="button" onclick="limpiarFirma()">Limpiar</button>
        <p id="firma" class="error_text"></p>
        <br>
    </div>

       {% endcomment %}
       
        <button type="submit" class="btn btn-success w-100" style="float: right">Enviar</button>
                </div>
              </div>
            <!-- ------------------- -->

           
           
            <script>
                console.log($('#id_tipo_clase'))
                let campos = document.querySelectorAll("input");
                let selects = document.querySelectorAll("select");
                selects.forEach(function(select) {
                    select.setAttribute("class", "form-control");
                });
                campos.forEach(function(campo) {
                    campo.setAttribute("class", "form-control");
                    if (campo.getAttribute('type')=="checkbox") {
                        campo.classList.remove("form-control");
                        campo.previousSibling.remove();
                        campo.parentNode.classList.add("checkbox");
                        campo.parentNode.childNodes[1].style.marginTop = "5px"
                        campo.style.height = "32px";
                    }
                }); 
            </script>
        </div>

        <br><br><br>
    </form>
</div>
{% endblock contenido %}


{% block scripts %}
<script src="{% static 'js/reglamento.js' %}"></script>
{% if form.errors %}
    <script>
        let errores = '{{form.errors|jsonify}}'
        errores = JSON.parse(errores)
        let form = $("#CrearEstudianteForm")
        form.find('.error_text').text('');
        form.find('.is-invalid').removeClass('is-invalid');
        for (let i in errores){
            let x=form.find('input[name='+i+']')
            let y=form.find('select[name='+i+']')
            x.addClass("is-invalid")
            y.addClass("is-invalid")
            $("#"+i).text(errores[i])
        }
        
    </script>
{% endif %}

<script src="https://cdn.jsdelivr.net/npm/signature_pad@2.3.2/dist/signature_pad.min.js"></script>
<!--  
<script>
//     window.addEventListener('load', async () => {
//         const canvas = document.querySelector("canvas");
//         canvas.height = canvas.offsetHeight;
//         canvas.width = canvas.offsetWidth;

//         signaturePad = new SignaturePad(canvas, {});
// });

// function limpiarFirma(){
//     signaturePad.clear();
// }

// $("#CrearEstudianteForm").submit(function(event){
//     event.preventDefault()
//     if(signaturePad.isEmpty()){
//         alert("esta vacio")
//     }else{
//         const canvas = $('#signature-canvas')
//         let img = signaturePad.toDataURL();
       
//     }
    
// })


</script>
-->
<script>

    function displayFile(drag){
        let fileType = file.type
        let validExtensions = ["image/jpeg", "image/jpg", "image/png", "application/pdf"]
        if (validExtensions.includes(fileType)){
            let fileReader = new FileReader()
            fileReader.onload=()=>{
                let fileURL = fileReader.result
                let imgTag = '<img src="'+fileURL+'" alt="">'
                drag.html(imgTag)
            };
            fileReader.readAsDataURL(file)
        }else{
            Swal.fire(
            'TIPO DE ARCHIVO INVÁLIDO',
            'Solo se pueden adjuntar imÁgenes JPG, JPEG, PNG y archivos PDF',
            'error'
            )
            drag.removeClass("active")
        }
        console.log(fileType)
        // console.log("solto el archivo")
    }

</script>

<script src="{% static 'libs/datepicker/dist/datepicker.js' %}"></script>
<script src="{% static 'libs/datepicker/i18n/datepicker.es-ES.js' %}"></script>

{% endblock scripts %}